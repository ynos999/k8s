# traefik-values.yaml
# --- Traefik Service konfigurācija (LoadBalancer ar specifisku IP) ---
service:
  enabled: true
  type: LoadBalancer
  annotations:
    # MetalLB anotācija, lai atļautu dalīt šo IP ar KeepAlived VIP (192.168.1.190)
    metallb.universe.tf/allow-shared-ip: "k8s-shared-vip" 
  spec:
    # MetalLB piešķirs tieši šo IP adresi (jābūt IPAddressPool)
    loadBalancerIP: 192.168.1.190 

# --- Traefik Konfigurācija (Ingress Controller) ---
providers:
  kubernetesIngress:
    enabled: true

# --- Traefik HTTPS/HTTP konfigurācija ---
# Ieslēgt TLS Listener (443 ports)
tls:
  enabled: true

# Definēt Globālo/Default TLS Konfigurāciju
globalArguments:
  - --entrypoints.web.address=:80
  - --entrypoints.websecure.address=:443
  
  # Iestatīt Default Sertifikātu uz jūsu wildcard sertifikātu
  - --entrypoints.websecure.tls.defaultcertificate.secretname=iloto-wildcard-tls
  - --entrypoints.websecure.tls.defaultcertificate.namespace=traefik

# HTTP uz HTTPS novirzīšana (Entrypoint 'web' uz 'websecure')
additionalArguments:
  - --entrypoints.web.http.redirections.entrypoint.to=:443
  - --entrypoints.web.http.redirections.entrypoint.scheme=https
  - --entrypoints.web.http.redirections.entrypoint.permanent=true

# --- Pārējie iestatījumi ---
ports:
  web:
    redirectTo: websecure # Tiek pārdefinēts ar additionalArguments
  websecure:
    tls:
      enabled: true

# Izmantojiet tikai Traefik vārda telpu
namespace: traefik