---
- name: Pārbaudīt, vai worker jau pievienots
  stat:
    path: /etc/kubernetes/kubelet.conf
  register: kubelet_conf_worker

- name: Pievienot worker mezglus
  ansible.builtin.shell: "{{ hostvars['master1'].join_cmd_worker | replace('\\n', ' ') | trim }}"
  args:
    executable: /bin/bash # Nodrošina, ka komanda tiek izpildīta ar uzticamu čaulu
  register: join_output
  changed_when: join_output.rc == 0
  when: kubelet_conf_worker.stat.exists == false
